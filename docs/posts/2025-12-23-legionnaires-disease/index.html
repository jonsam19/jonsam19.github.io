<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jonas Samuelsson">
<meta name="dcterms.date" content="2023-03-16">
<meta name="description" content="How advanced time series analysis revealed a significant epidemiological shift across 25 European countries">

<title>Detecting Disease Trends: Statistical Evidence of Europe’s Rising Legionnaires’ Disease Burden – Jonas Samuelsson</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-34e9bac5df10ac61b179e8130ae60399.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jonas Samuelsson</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../media/CV_Jonas_Samuelsson.pdf"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#study-objectives" id="toc-study-objectives" class="nav-link" data-scroll-target="#study-objectives">Study Objectives</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection">1. Data Collection</a></li>
  <li><a href="#retrospective-prediction-model" id="toc-retrospective-prediction-model" class="nav-link" data-scroll-target="#retrospective-prediction-model">2. Retrospective Prediction Model</a></li>
  <li><a href="#interrupted-time-series-analysis" id="toc-interrupted-time-series-analysis" class="nav-link" data-scroll-target="#interrupted-time-series-analysis">3. Interrupted Time Series Analysis</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#retrospective-prediction-analysis" id="toc-retrospective-prediction-analysis" class="nav-link" data-scroll-target="#retrospective-prediction-analysis">Retrospective Prediction Analysis</a></li>
  <li><a href="#interrupted-time-series-analysis-1" id="toc-interrupted-time-series-analysis-1" class="nav-link" data-scroll-target="#interrupted-time-series-analysis-1">Interrupted Time Series Analysis</a></li>
  <li><a href="#stratified-analysis" id="toc-stratified-analysis" class="nav-link" data-scroll-target="#stratified-analysis">Stratified Analysis</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a>
  <ul class="collapse">
  <li><a href="#sensitivity-analysis" id="toc-sensitivity-analysis" class="nav-link" data-scroll-target="#sensitivity-analysis">Sensitivity Analysis</a></li>
  <li><a href="#potential-contributing-factors" id="toc-potential-contributing-factors" class="nav-link" data-scroll-target="#potential-contributing-factors">Potential Contributing Factors</a></li>
  <li><a href="#study-limitations" id="toc-study-limitations" class="nav-link" data-scroll-target="#study-limitations">Study Limitations</a></li>
  </ul></li>
  <li><a href="#code-and-data-availability" id="toc-code-and-data-availability" class="nav-link" data-scroll-target="#code-and-data-availability">Code and Data Availability</a></li>
  <li><a href="#publication-and-resources" id="toc-publication-and-resources" class="nav-link" data-scroll-target="#publication-and-resources">Publication and Resources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Detecting Disease Trends: Statistical Evidence of Europe’s Rising Legionnaires’ Disease Burden</h1>
  <div class="quarto-categories">
    <div class="quarto-category">epidemiology</div>
    <div class="quarto-category">time-series-analysis</div>
    <div class="quarto-category">forecasting</div>
    <div class="quarto-category">public-health</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">surveillance</div>
  </div>
  </div>

<div>
  <div class="description">
    How advanced time series analysis revealed a significant epidemiological shift across 25 European countries
  </div>
</div>


<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jonas Samuelsson </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 16, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>The annual Legionnaires’ disease (LD) notification rate in the EU/EEA increased from 1.2-1.4 cases per 100,000 population during 2012-2016 to 1.8-2.2 per 100,000 during 2017-2019. Since there were no changes in the EU/EEA surveillance case definition, surveillance system, or reported outbreak events that could explain these increases, we hypothesized a change in disease trend.</p>
<p>As lead analyst at ECDC’s Scientific Methods and Standards Unit, I worked with colleagues to measure weekly excess cases during 2017-2019 based on previous trends and determine whether a significant change in trend had occurred.</p>
</section>
<section id="study-objectives" class="level2">
<h2 class="anchored" data-anchor-id="study-objectives">Study Objectives</h2>
<p>We aimed to:</p>
<ol type="1">
<li>Analyze whether the number of observed cases in the EU/EEA during 2017-2019 was statistically significantly higher compared with 2012-2016</li>
<li>Estimate any significant change (increase) in trend in 2017-2019 compared with 2012-2016</li>
<li>Assess if there were differences according to age, sex, or importation of infection</li>
</ol>
<p>Understanding whether this represented a genuine trend change versus natural variation would help inform public health surveillance priorities and prevention strategies across Europe.</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p>We used two complementary time series analysis methods to assess the observed increase.</p>
<section id="data-collection" class="level3">
<h3 class="anchored" data-anchor-id="data-collection">1. Data Collection</h3>
<p>We analyzed data from ECDC’s European Surveillance System (TESSy):</p>
<ul>
<li><strong>55,821 Legionnaires’ disease cases</strong> from 25 EU/EEA countries</li>
<li><strong>Study period:</strong> 2012-2019 (8 years of weekly data)</li>
<li><strong>Standardized case definitions</strong> ensuring comparability across countries</li>
</ul>
<p>Five countries were excluded due to lack of weekly date variables or importation status information (Germany, Bulgaria, Luxembourg, Croatia, Iceland), representing 13.4% of the initial dataset.</p>
</section>
<section id="retrospective-prediction-model" class="level3">
<h3 class="anchored" data-anchor-id="retrospective-prediction-model">2. Retrospective Prediction Model</h3>
<p>We created a retrospective prediction of LD cases in 2017-2019 based on 2012-2016 data using harmonic regression models with ARIMA errors.</p>
<p><strong>Model components:</strong></p>
<ul>
<li>Fourier terms to capture seasonal patterns</li>
<li>ARIMA components for trend and autocorrelation<br>
</li>
<li>Log transformation of observed data</li>
<li>Automated model selection using Akaike Information Criterion (AIC)</li>
</ul>
<p>This approach allowed us to estimate what case numbers would have been expected in 2017-2019 if the 2012-2016 pattern had continued, then compare observed versus predicted cases.</p>
</section>
<section id="interrupted-time-series-analysis" class="level3">
<h3 class="anchored" data-anchor-id="interrupted-time-series-analysis">3. Interrupted Time Series Analysis</h3>
<p>We used interrupted time series (ITS) regression to determine if there was a significant change in trend during 2017-2019 compared with 2012-2016.</p>
<p><strong>ITS methodology:</strong></p>
<ul>
<li>Seasonal component removed using STL decomposition</li>
<li>Linear regression comparing trends before and after 2017</li>
<li>Autoregressive terms added to account for serial correlation</li>
<li>Statistical testing of whether trend slopes differed significantly between periods</li>
</ul>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>Both analytical methods indicated that the observed increase in 2017-2019 was statistically significant compared with the 2012-2016 period.</p>
<section id="retrospective-prediction-analysis" class="level3">
<h3 class="anchored" data-anchor-id="retrospective-prediction-analysis">Retrospective Prediction Analysis</h3>
<p>The forecasting model showed that observed cases during 2017-2019 exceeded predicted levels:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Metric</th>
<th>2017</th>
<th>2018</th>
<th>2019</th>
<th>2017-2019 Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Observed cases</strong></td>
<td>7,935</td>
<td>9,854</td>
<td>9,741</td>
<td>27,530</td>
</tr>
<tr class="even">
<td><strong>Predicted cases</strong></td>
<td>6,525</td>
<td>6,849</td>
<td>7,193</td>
<td>20,566</td>
</tr>
<tr class="odd">
<td><strong>Excess cases</strong></td>
<td>1,410</td>
<td>3,005</td>
<td>2,548</td>
<td>6,964 (33.9%)</td>
</tr>
<tr class="even">
<td><strong>Cases above 80% PI</strong></td>
<td>409</td>
<td>1,456</td>
<td>955</td>
<td>2,820</td>
</tr>
<tr class="odd">
<td><strong>Weeks above 95% PI</strong></td>
<td>7</td>
<td>19</td>
<td>13</td>
<td>39 weeks</td>
</tr>
</tbody>
</table>
<p>The model predicted 20,566 cases for 2017-2019 based on 2012-2016 data. We observed 27,530 cases—an excess of 6,964 cases (33.9%). Over the three-year period, 85 weeks had cases above the 80% prediction interval, and 39 weeks exceeded the 95% prediction interval.</p>
</section>
<section id="interrupted-time-series-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="interrupted-time-series-analysis-1">Interrupted Time Series Analysis</h3>
<p>The ITS regression tested whether the trend in weekly cases changed significantly between the two periods:</p>
<ul>
<li><strong>2012-2016 trend:</strong> β₁ = 0.044 (95% CI: -0.003 to 0.091, p = 0.064) - no significant trend</li>
<li><strong>2017-2019 trend change:</strong> β₃ = 0.135 (95% CI: 0.022 to 0.248, p = 0.019) - significant positive change</li>
</ul>
<p>The analysis indicated a statistically significant increase in trend beginning in 2017 compared with the previous five years.</p>
</section>
<section id="stratified-analysis" class="level3">
<h3 class="anchored" data-anchor-id="stratified-analysis">Stratified Analysis</h3>
<p>The analysis was repeated for different subgroups to understand where increases were most pronounced:</p>
<p><strong>Age groups:</strong></p>
<ul>
<li>Excess cases were observed across all age groups (19.8% to 47.0% above predicted)</li>
<li>The strongest significant trend increases were observed in age groups &gt;60 years:
<ul>
<li>60-69 years: β₃ = 0.054 (p = 0.004)</li>
<li>70-79 years: β₃ = 0.046 (p &lt; 0.001)</li>
<li>≥80 years: β₃ = 0.041 (p = 0.001)</li>
</ul></li>
</ul>
<p><strong>Sex:</strong></p>
<ul>
<li>Males: No significant trend in 2012-2016, but significant trend increase in 2017-2019 (β₃ = 0.094, p = 0.033)</li>
<li>Females: Positive trend in 2012-2016, with additional significant increase in 2017-2019 (β₃ = 0.065, p = 0.001)</li>
</ul>
<p><strong>Origin:</strong></p>
<ul>
<li>Domestic cases: Significant trend increase in 2017-2019 (β₃ = 0.125, p = 0.021)</li>
<li>Imported cases: Positive trend in 2012-2016, but no significant trend change in 2017-2019 (β₃ = -0.007, p = 0.38)</li>
</ul>
<p>These findings indicated that the increase was most pronounced in older age groups and in non-travel-related cases.</p>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>Our study showed a significant increasing trend in LD cases in the EU/EEA during 2017-2019 compared with the previous five years. The distribution of cases per week suggested an overall amplification of seasonal trends, with summer peaks in 2017-2019 growing higher than the 2012-2016 range.</p>
<section id="sensitivity-analysis" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-analysis">Sensitivity Analysis</h3>
<p>In November 2014, Portugal experienced an outbreak contributing 291 cases. To assess whether this influenced our findings, we repeated the analysis excluding these cases. The results showed a 35.4% excess (compared to 33.9% with the outbreak included), with differences mainly in late 2019. This confirmed that our main findings were not driven by the 2014 outbreak.</p>
</section>
<section id="potential-contributing-factors" class="level3">
<h3 class="anchored" data-anchor-id="potential-contributing-factors">Potential Contributing Factors</h3>
<p>While this study established that the trend changed, it did not aim to identify causal factors. However, several factors may have contributed to the observed increase:</p>
<p><strong>Demographic changes:</strong> Europe’s population aged 65+ increased by 3.0 percentage points as a share of total population between 2010-2020. Since older individuals are at higher risk for LD, demographic aging may contribute to rising case numbers.</p>
<p><strong>Climate patterns:</strong> Studies have found associations between LD incidence and weather conditions such as warmer temperatures, higher humidity, and increased rainfall. The years 2014, 2015, 2018, and 2019 were among Europe’s warmest years on record by the end of 2019.</p>
<p><strong>Building water systems:</strong> Risk factors for Legionella growth in engineered water systems include system design, water temperature, and biofilm accumulation. Changes in building practices or maintenance could influence disease risk.</p>
<p><strong>Tourism patterns:</strong> Tourism statistics showed a continuous increase in nights spent in tourist accommodation establishments by both domestic and international guests during 2012-2019, though imported cases did not show a significant trend increase in our analysis.</p>
<p>These potential contributing factors warrant further investigation to better understand the determinants of the observed increase.</p>
</section>
<section id="study-limitations" class="level3">
<h3 class="anchored" data-anchor-id="study-limitations">Study Limitations</h3>
<p>The analysis excluded five countries due to incomplete data, representing 13.4% of initially available cases. However, the percentage of excluded cases remained stable across years (10.9%-14.3%), suggesting minimal impact on trend assessment.</p>
</section>
</section>
<section id="code-and-data-availability" class="level2">
<h2 class="anchored" data-anchor-id="code-and-data-availability">Code and Data Availability</h2>
<p>The analysis code is available on GitHub: <a href="https://github.com/EU-ECDC/LegionnairesDiseaseInEUEEA">EU-ECDC/LegionnairesDiseaseInEUEEA</a></p>
<p>The repository includes:</p>
<ul>
<li>R scripts for time series model fitting (fable package)</li>
<li>Interrupted time series regression implementation<br>
</li>
<li>Stratified analysis code for age/sex/origin subgroups</li>
<li>Visualization code for figures</li>
<li>Complete methodology documentation</li>
</ul>
<p>The analysis was conducted using R software (version 4.0.5) with the tidyverts packages (tsibble, fable, fabletools, feasts).</p>
<hr>
</section>
<section id="publication-and-resources" class="level2">
<h2 class="anchored" data-anchor-id="publication-and-resources">Publication and Resources</h2>
<p><strong>Full publication:</strong> Samuelsson J, Payne Hallström L, Marrone G, Gomes Dias J. Legionnaires’ disease in the EU/EEA: increasing trend from 2017 to 2019. <em>Euro Surveill.</em> 2023;28(11):pii=2200114. <a href="https://doi.org/10.2807/1560-7917.ES.2023.28.11.2200114">https://doi.org/10.2807/1560-7917.ES.2023.28.11.2200114</a></p>
<p><strong>Additional resources:</strong></p>
<ul>
<li><a href="https://github.com/EU-ECDC/LegionnairesDiseaseInEUEEA">GitHub repository with analysis code</a></li>
<li><a href="https://www.ecdc.europa.eu/en/legionnaires-disease">ECDC annual Legionnaires’ disease surveillance reports</a></li>
<li><a href="https://linkedin.com/in/jonsam19">LinkedIn</a> | <a href="https://github.com/jonsam19">GitHub</a> | <a href="https://scholar.google.com/citations?user=rXyIKPUAAAAJ">Google Scholar</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 Jonas Samuelsson. Built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://www.linkedin.com/in/jonsam19/"><i class="fa-brands fa-linkedin" aria-label="linkedin"></i></a> <a href="https://github.com/jonsam19"><i class="fa-brands fa-github" aria-label="github"></i></a> <a href="https://scholar.google.com/citations?user=rXyIKPUAAAAJ&amp;hl=en"><i class="fa-brands fa-google-scholar" aria-label="google-scholar"></i></a> <a href="mailto:jonas.samuelsson19@gmail.com"><i class="fa-solid fa-envelope" aria-label="envelope"></i></a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>